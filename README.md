# Pultimate V2 - Rebuild Engine

Pultimate V2 is a presentation rebuilding engine that preserves content exactly while applying new templates. It uses a "Golden Set" validation approach and a strict NO-GEN policy (content is copied, never generated by LLM).

## Architecture

- **Frontend**: Next.js 14 (App Router) - `apps/web`
- **Backend**: FastAPI (Python 3.11) - `apps/api`
- **Worker**: Celery + Redis - `apps/api/worker.py`
- **Database**: PostgreSQL (Supabase/Fly)
- **Storage**: Cloudflare R2 (S3 compatible)

## Development Setup

1. **Start Platform**:
   ```powershell
   .\start_platform.ps1
   ```

2. **Access Services**:
   - Frontend: http://localhost:3000
   - API Docs: http://localhost:8000/docs
   - Worker: (Background process)

## Production Deployment

### Required Secrets

The following environment variables must be set in production (e.g., Fly.io secrets):

| Secret | Service | Description |
|--------|---------|-------------|
| `DATABASE_URL` | API, Worker | PostgreSQL connection string (async/sync handled auto) |
| `REDIS_URL` | API, Worker | Redis connection string for Celery broker/backend |
| `SECRET_KEY` | API | Secret key for JWT signing |
| `OPENAI_API_KEY` | Worker | Required if `LLM_PROVIDER=openai` |
| `S3_ENDPOINT_URL` | API, Worker | S3-compatible endpoint (e.g., Cloudflare R2 URL) |
| `S3_ACCESS_KEY_ID` | API, Worker | S3 Access Key |
| `S3_SECRET_ACCESS_KEY` | API, Worker | S3 Secret Key |
| `S3_BUCKET` | API, Worker | S3 Bucket Name |
| `S3_REGION` | API, Worker | S3 Region (e.g., auto or us-east-1) |
| `API_BASE` | Web | URL of the backend API (e.g., `https://api.pultimate.com`) |

### Deployment Commands

**API**:
```bash
fly deploy -c fly.toml
```

**Worker**:
```bash
fly deploy -c fly.worker.toml
```

## Golden Set Validation

Run the validation suite to ensure content preservation:

```bash
cd apps/api
pytest tests/test_golden_set.py
```
